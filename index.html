<!DOCTYPE HTML>
<!--
	Hyperspace by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>

	<head>
		<title>Quantum Safari</title>
		<meta  http-equiv="Content-Type" content="application;charset=UTF-8">
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
		<link rel="icon" type="image/png" href="favicon-16x16.png" sizes="16x16" />
		</head>
	<body class="is-preload">


		<!-- Wrapper -->
		<div id="wrapper">
			<section id="one" class="wrapper style1 fullscreen fade-up">
				<div class="inner">
					<h1 id="testss">Quantum Safari</h1>
					<p>New album coming soon!! Check out the current state of it below (almost finished :D )</p>
					<p>In the meantime, feel free to check out <a href="https://brianhasgoodphotos.info/s/yonxtHHieRQzxn2"><bold></bold>this link</bold></a> as you listen.</p>
					<p>I'll be posting updates here, so stay tuned.</p>
				</div>
				<div id="song_list">
					<div class="button" onclick="changeSong('1')">1. Spooky Overture?</div>
					<div class="button" onclick="changeSong('2')">2. Lights Out</div>
					<div class="button" onclick="changeSong('3')">3. And I'm Gone</div>
					<div class="button" onclick="changeSong('4')">4. Be Seen on Halloween</div>
					<div class="button" onclick="changeSong('5')">5. Two for the Toads</div>
					<div class="button" onclick="changeSong('6')">6. Good Idea, Bad Execution</div>
					<div class="button" onclick="changeSong('7')">7. Echoes of the Moon</div>
					<div class="button" onclick="changeSong('8')">8. Give it a Try</div>
					<div class="button" onclick="changeSong('9')">9. Be seein' you</div>
				</div>
				<div id="art_wrap"> <img id="art" src="images/1.jpg" width="auto" height="500px"> </div>
				<div id="audio-player-container">
					<audio src="songs/1.mp3" preload="metadata"></audio>
					<input type="range" id="seek-slider" max="100" value="0">
					<span id="current-time" class="time">0:00</span>
					<span id="duration" class="time">0:00</span>
					<input type="range" id="volume-slider" max="100" value="100">
					<output id="volume-output">100</output>
					<br>
					<button id="play-icon"><i class='material-icons'>play_arrow</i></button>
					<button id="prev-icon" onclick="prevSong()"><i class='material-icons'>skip_previous</i></button>
					<button id="next-icon" onclick="nextSong()"><i class='material-icons'>skip_next</i></button>
					<button id="mute-icon" style="float: right;"><i class='material-icons'>volume_up</i></button>
				</div>
			</section>
		</div>


		<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700&display=swap" rel="stylesheet">

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>
			<script>
			/* Implementation of the presentation of the audio player */

			const playIconContainer = document.getElementById('play-icon');
			const audioPlayerContainer = document.getElementById('audio-player-container');
			const seekSlider = document.getElementById('seek-slider');
			const volumeSlider = document.getElementById('volume-slider');
			const muteIconContainer = document.getElementById('mute-icon');
			let playState = 'play';
			let muteState = 'unmute';
			let song = 1;

			const updatePlayState = () => {
				if(playState === 'play') {
					audio.play();
					requestAnimationFrame(whilePlaying);
					playIconContainer.innerHTML = "<i class='material-icons'>pause</i>";
					playState = 'pause';
				} else {
					audio.pause();
					cancelAnimationFrame(raf);
					playIconContainer.innerHTML = "<i class='material-icons'>play_arrow</i>";
					playState = 'play';
				}
			}

			playIconContainer.addEventListener('click', () => {
				updatePlayState();
			});

			muteIconContainer.addEventListener('click', () => {
				if(muteState === 'unmute') {
					audio.muted = true;
					muteIconContainer.innerHTML = "<i class='material-icons'>volume_off</i>";
					muteState = 'mute';
				} else {
					audio.muted = false;
					muteIconContainer.innerHTML = "<i class='material-icons'>volume_up</i>";
					muteState = 'unmute';
				}
			});

			const showRangeProgress = (rangeInput) => {
				if(rangeInput === seekSlider) audioPlayerContainer.style.setProperty('--seek-before-width', rangeInput.value / rangeInput.max * 100 + '%');
				else audioPlayerContainer.style.setProperty('--volume-before-width', rangeInput.value / rangeInput.max * 100 + '%');
			}

			seekSlider.addEventListener('input', (e) => {
				showRangeProgress(e.target);
			});
			volumeSlider.addEventListener('input', (e) => {
				showRangeProgress(e.target);
			});





			/* Implementation of the functionality of the audio player */

			const audio = document.querySelector('audio');
			const durationContainer = document.getElementById('duration');
			const currentTimeContainer = document.getElementById('current-time');
			const outputContainer = document.getElementById('volume-output');
			let raf = null;

			const calculateTime = (secs) => {
				const minutes = Math.floor(secs / 60);
				const seconds = Math.floor(secs % 60);
				const returnedSeconds = seconds < 10 ? `0${seconds}` : `${seconds}`;
				return `${minutes}:${returnedSeconds}`;
			}

			function displayDuration () {
				durationContainer.textContent = calculateTime(audio.duration);
			}

			const setSliderMax = () => {
				seekSlider.max = Math.floor(audio.duration);
			}

			const displayBufferedAmount = () => {
				const bufferedAmount = Math.floor(audio.buffered.end(audio.buffered.length - 1));
				audioPlayerContainer.style.setProperty('--buffered-width', `${(bufferedAmount / seekSlider.max) * 100}%`);
			}

			const whilePlaying = () => {
				seekSlider.value = Math.floor(audio.currentTime);
				currentTimeContainer.textContent = calculateTime(seekSlider.value);
				audioPlayerContainer.style.setProperty('--seek-before-width', `${seekSlider.value / seekSlider.max * 100}%`);
				raf = requestAnimationFrame(whilePlaying);
			}

			const nextSong = () => {
				if (song == 9) {
					updatePlayState();
				} else {
					song++;
					changeSong(song);
				}
				seekSlider.value = Math.floor(audio.currentTime);
				currentTimeContainer.textContent = calculateTime(seekSlider.value);
				audioPlayerContainer.style.setProperty('--seek-before-width', `${seekSlider.value / seekSlider.max * 100}%`);
				raf = requestAnimationFrame(whilePlaying);
			}

			const prevSong = () => {
				if (song == 1) {
					changeSong(song);
					updatePlayState();
				} else {
					if (audio.currentTime < 5) {
						song--;
					}
					changeSong(song);
				}
				seekSlider.value = Math.floor(audio.currentTime);
				currentTimeContainer.textContent = calculateTime(seekSlider.value);
				audioPlayerContainer.style.setProperty('--seek-before-width', `${seekSlider.value / seekSlider.max * 100}%`);
				raf = requestAnimationFrame(whilePlaying);
			}
			
			if (audio.readyState > 0) {
				displayDuration();
				setSliderMax();
				displayBufferedAmount();
			} else {
				audio.addEventListener('loadedmetadata', () => {
					displayDuration();
					setSliderMax();
					displayBufferedAmount();
				});
			}

			audio.addEventListener('durationchange', () => {
				displayDuration();
				setSliderMax();
				displayBufferedAmount();
			});


			audio.addEventListener('progress', displayBufferedAmount);

			audio.addEventListener('ended', nextSong);

			seekSlider.addEventListener('input', () => {
				currentTimeContainer.textContent = calculateTime(seekSlider.value);
				if(!audio.paused) {
					cancelAnimationFrame(raf);
				}
			});

			seekSlider.addEventListener('change', () => {
				audio.currentTime = seekSlider.value;
				if(!audio.paused) {
					requestAnimationFrame(whilePlaying);
				}
			});

			volumeSlider.addEventListener('input', (e) => {
				const value = e.target.value;

				outputContainer.textContent = value;
				audio.volume = value / 100;
			});


			/* MEEEEEEEEEEEEEEEEE  */ 
			function changeSong(s) {
				song = s;
				audio.src='songs/' + s + '.mp3';
				audio.load();
				playState = 'play'
				updatePlayState();
				document.getElementById('art').src='images/' + s + '.jpg';

			}


			/* Implementation of the Media Session API */
			if('mediaSession' in navigator) {
				navigator.mediaSession.metadata = new MediaMetadata({
					title: 'Halloween Album',
					artist: 'Quantum Safari',
					album: 'Halloween: a Halloweeny Halloween',
					artwork: [
						{ src: 'images/1/96.jpg',  sizes: '96x96',   type: 'image/png' },
						{ src: 'images/1/128.jpg', sizes: '128x128', type: 'image/png' },
						{ src: 'images/1/192.jpg', sizes: '192x192', type: 'image/png' },
						{ src: 'images/1/256.jpg', sizes: '256x256', type: 'image/png' },
						{ src: 'images/1/384.jpg', sizes: '384x384', type: 'image/png' },
						{ src: 'images/1/512.jpg', sizes: '512x512', type: 'image/png' },
					]
				});
				navigator.mediaSession.setActionHandler('play', () => {
					if(playState === 'play') {
						audio.play();
						requestAnimationFrame(whilePlaying);
						playState = 'pause';
					} else {
						audio.pause();
						cancelAnimationFrame(raf);
						playState = 'play';
					}
				});
				navigator.mediaSession.setActionHandler('pause', () => {
					if(playState === 'play') {
						audio.play();
						requestAnimationFrame(whilePlaying);
						playState = 'pause';
					} else {
						audio.pause();
						cancelAnimationFrame(raf);
						playState = 'play';
					}
				});
				navigator.mediaSession.setActionHandler('nexttrack', (details) => {
					nextSong();
				});
				navigator.mediaSession.setActionHandler('previoustrack', (details) => {
					prevSong();
				});
				navigator.mediaSession.setActionHandler('seekbackward', (details) => {
					audio.currentTime = audio.currentTime - (details.seekOffset || 10);
				});
				navigator.mediaSession.setActionHandler('seekforward', (details) => {
					audio.currentTime = audio.currentTime + (details.seekOffset || 10);
				});
				navigator.mediaSession.setActionHandler('seekto', (details) => {
					if (details.fastSeek && 'fastSeek' in audio) {
					audio.fastSeek(details.seekTime);
					return;
					}
					audio.currentTime = details.seekTime;
				});
				navigator.mediaSession.setActionHandler('stop', () => {
					audio.currentTime = 0;
					seekSlider.value = 0;
					audioPlayerContainer.style.setProperty('--seek-before-width', '0%');
					currentTimeContainer.textContent = '0:00';
					if(playState === 'pause') {
						cancelAnimationFrame(raf);
						playState = 'play';
					}
				});
			}
			</script>			  


	</body>
</html>