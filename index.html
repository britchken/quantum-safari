<!DOCTYPE HTML>
<!--
	Hyperspace by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>

	<head>
		<title>Quantum Safari</title>
		<meta  http-equiv="Content-Type" content="application;charset=UTF-8">
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
		<link rel="icon" type="image/png" href="favicon-16x16.png" sizes="16x16" />
		</head>
	<body class="is-preload">

		<!-- Sidebar -->
		<section id="sidebar">
			<div class="inner">
				<nav>
					<ul>
						<li><a href="#intro">Lank's fantastic paintings!</a></li>
					</ul>
				</nav>
			</div>
		</section>

		<!-- Wrapper -->
		<div id="wrapper">

			<!--
			<section id="intro" class="wrapper style1 fullscreen fade-up">
				<div class="inner">
					<h1 id="testss">Quantum Safari</h1>
					<p>Halloween album coming soon! Scroll down to see the progress!</p>
					<ul class="actions">
						<li><a href="https://brianhasgoodphotos.info/s/3pq784ofjabe2rp" class="button">Click here to see the progress!</a></li>
					</ul>
				</div>
			</section>-->

			<!-- One -->
			<section id="intro" class="wrapper style1 fullscreen fade-up">
				<div class="inner">
					<h1>Quantum Safari</h1>
			    	<p>Halloween album coming soon! Listen to it below (work in progress)</p>
				</div>
				<div id="song_list">
					<div class="button" onclick="changeSong('1')">1. Spooky Overture?</div>
					<div class="button" onclick="changeSong('2')">2. Lights Out</div>
					<div class="button" onclick="changeSong('3')">3. And I'm Gone</div>
					<div class="button" onclick="changeSong('4')">4. Be Seen on Halloween</div>
					<div class="button" onclick="changeSong('5')">5. Two for the Toads</div>
					<div class="button" onclick="changeSong('6')">6. Good Idea, Bad Execution</div>
					<div class="button" onclick="changeSong('7')">7. Echoes of the Moon</div>
					<div class="button" onclick="changeSong('8')">8. Give it a Try</div>
					<div class="button" onclick="changeSong('9')">9. Be seein' you</div>
				</div>
				<div id="art_wrap"> <img id="art" src="images/1.jpg" width="auto" height="500px"> </div>
				<div id="audio-player-container">
					<audio src="songs/1.mp3" preload="metadata" loop></audio>
					<button id="play-icon"></button>
					<span id="current-time" class="time">0:00</span>
					<input type="range" id="seek-slider" max="100" value="0">
					<span id="duration" class="time">0:00</span>
					<output id="volume-output">100</output>
					<input type="range" id="volume-slider" max="100" value="100">
					<button id="mute-icon"></button>
				</div>
			</section>
		</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>
			<script>
			/* Implementation of the presentation of the audio player */
			const playIconContainer = document.getElementById('play-icon');
			const audioPlayerContainer = document.getElementById('audio-player-container');
			const seekSlider = document.getElementById('seek-slider');
			const volumeSlider = document.getElementById('volume-slider');
			const muteIconContainer = document.getElementById('mute-icon');
			let playState = 'play';
			let muteState = 'unmute';


			const updatePlayState = () => {
				if(playState === 'play') {
					audio.play();
					playState = 'pause';
				} else {
					audio.pause();
					playState = 'play';
				}
			}

			playIconContainer.addEventListener('click', () => {
				updatePlayState();
			});

			muteIconContainer.addEventListener('click', () => {
				if(muteState === 'unmute') {
					audio.muted = true;
					muteState = 'mute';
				} else {
					audio.muted = false;
					muteState = 'unmute';
				}
			});

			const showRangeProgress = (rangeInput) => {
				if(rangeInput === seekSlider) audioPlayerContainer.style.setProperty('--seek-before-width', rangeInput.value / rangeInput.max * 100 + '%');
				else audioPlayerContainer.style.setProperty('--volume-before-width', rangeInput.value / rangeInput.max * 100 + '%');
			}

			seekSlider.addEventListener('input', (e) => {
				showRangeProgress(e.target);
			});
			volumeSlider.addEventListener('input', (e) => {
				showRangeProgress(e.target);
			});





			/* Implementation of the functionality of the audio player */

			const audio = document.querySelector('audio');
			const durationContainer = document.getElementById('duration');
			const currentTimeContainer = document.getElementById('current-time');
			const outputContainer = document.getElementById('volume-output');
			let raf = null;

			const calculateTime = (secs) => {
				const minutes = Math.floor(secs / 60);
				const seconds = Math.floor(secs % 60);
				const returnedSeconds = seconds < 10 ? `0${seconds}` : `${seconds}`;
				return `${minutes}:${returnedSeconds}`;
			}

			function displayDuration () {
				durationContainer.textContent = calculateTime(audio.duration);
			}

			const setSliderMax = () => {
				seekSlider.max = Math.floor(audio.duration);
			}

			const displayBufferedAmount = () => {
				const bufferedAmount = Math.floor(audio.buffered.end(audio.buffered.length - 1));
				audioPlayerContainer.style.setProperty('--buffered-width', `${(bufferedAmount / seekSlider.max) * 100}%`);
			}

			const whilePlaying = () => {
				seekSlider.value = Math.floor(audio.currentTime);
				currentTimeContainer.textContent = calculateTime(seekSlider.value);
				audioPlayerContainer.style.setProperty('--seek-before-width', `${seekSlider.value / seekSlider.max * 100}%`);
			}

			if (audio.readyState > 0) {
				displayDuration();
				setSliderMax();
				displayBufferedAmount();
			} else {
				audio.addEventListener('loadedmetadata', () => {
					displayDuration();
					setSliderMax();
					displayBufferedAmount();
				});
			}

			audio.addEventListener('durationchange', () => {
				displayDuration();
				setSliderMax();
				displayBufferedAmount();
			});


			audio.addEventListener('progress', displayBufferedAmount);

			seekSlider.addEventListener('input', () => {
				currentTimeContainer.textContent = calculateTime(seekSlider.value);
			});

			seekSlider.addEventListener('change', () => {
				audio.currentTime = seekSlider.value;
			});

			volumeSlider.addEventListener('input', (e) => {
				const value = e.target.value;

				outputContainer.textContent = value;
				audio.volume = value / 100;
			});


			/* MEEEEEEEEEEEEEEEEE  */ 
			function changeSong(song) {
				console.log(calculateTime(audio.duration))
				audio.src='songs/' + song + '.mp3';
				console.log(audio.duration);
				audio.load();
				playState = 'play'
				updatePlayState();
				document.getElementById('art').src='images/' + song + '.jpg';

			}


			/* Implementation of the Media Session API */
			if('mediaSession' in navigator) {
				navigator.mediaSession.metadata = new MediaMetadata({
					title: 'Halloween Album',
					artist: 'Quantum Safari',
					album: 'Halloween: a Halloweeny Halloween',
					artwork: [
						{ src: 'images/1/96.jpg',  sizes: '96x96',   type: 'image/png' },
						{ src: 'images/1/128.jpg', sizes: '128x128', type: 'image/png' },
						{ src: 'images/1/192.jpg', sizes: '192x192', type: 'image/png' },
						{ src: 'images/1/256.jpg', sizes: '256x256', type: 'image/png' },
						{ src: 'images/1/384.jpg', sizes: '384x384', type: 'image/png' },
						{ src: 'images/1/512.jpg', sizes: '512x512', type: 'image/png' },
					]
				});
				navigator.mediaSession.setActionHandler('play', () => {
					if(playState === 'play') {
						audio.play();
						playState = 'pause';
					} else {
						audio.pause();
						playState = 'play';
					}
				});
				navigator.mediaSession.setActionHandler('pause', () => {
					if(playState === 'play') {
						audio.play();
						playState = 'pause';
					} else {
						audio.pause();
						playState = 'play';
					}
				});
				navigator.mediaSession.setActionHandler('seekbackward', (details) => {
					audio.currentTime = audio.currentTime - (details.seekOffset || 10);
				});
				navigator.mediaSession.setActionHandler('seekforward', (details) => {
					audio.currentTime = audio.currentTime + (details.seekOffset || 10);
				});
				navigator.mediaSession.setActionHandler('seekto', (details) => {
					if (details.fastSeek && 'fastSeek' in audio) {
					audio.fastSeek(details.seekTime);
					return;
					}
					audio.currentTime = details.seekTime;
				});
				navigator.mediaSession.setActionHandler('stop', () => {
					audio.currentTime = 0;
					seekSlider.value = 0;
					audioPlayerContainer.style.setProperty('--seek-before-width', '0%');
					currentTimeContainer.textContent = '0:00';
					if(playState === 'pause') {
						playState = 'play';
					}
				});
			}
			</script>			  


	</body>
</html>